/*global history */                                                                                                                                                                                                                                            
sap.ui.define([                                                                                                                                                                                                                                                
	"com/mscg/applications/cubiscan/measure/controller/BaseController",                                                                                                                                                                                           
	"sap/ui/model/json/JSONModel",                                                                                                                                                                                                                                
	"sap/ui/core/routing/History",                                                                                                                                                                                                                                
	"sap/ui/model/Filter",                                                                                                                                                                                                                                        
	"sap/ui/model/FilterOperator",                                                                                                                                                                                                                                
	"sap/m/GroupHeaderListItem",                                                                                                                                                                                                                                  
	"sap/ui/Device",                                                                                                                                                                                                                                              
	"com/mscg/applications/cubiscan/measure/model/formatter"                                                                                                                                                                                                      
], function(BaseController, JSONModel, History, Filter, FilterOperator, GroupHeaderListItem, Device, formatter) {                                                                                                                                              
	"use strict";                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
	return BaseController.extend("com.mscg.applications.cubiscan.measure.controller.Master", {                                                                                                                                                                    
                                                                                                                                                                                                                                                               
		formatter: formatter,                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		/* =========================================================== */                                                                                                                                                                                            
		/* lifecycle methods                                           */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Called when the master list controller is instantiated. It sets up the event handling for the master/detail communication and other lifecycle tasks.                                                                                                      
		 * @public                                                                                                                                                                                                                                                   
		 */                                                                                                                                                                                                                                                          
		onInit: function() {                                                                                                                                                                                                                                         
			// Control state model                                                                                                                                                                                                                                      
			var oList = this.byId("list");                                                                                                                                                                                                                              
			var oViewModel = this._createViewModel();                                                                                                                                                                                                                   
			this.setModel(oViewModel, "masterView");                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			// Subscribe to the Fiori Configuration loaded channel so that once it is complete we can start the web socket connection.                                                                                                                                  
			var oEventBus = sap.ui.getCore().getEventBus();                                                                                                                                                                                                             
			oEventBus.subscribe("com.mscg.applications.cubiscan.measure.FioriConfiguration", "Loaded", this.onFioriConfigurationLoaded, this);                                                                                                                          
                                                                                                                                                                                                                                                               
			// Put down master list's original value for busy indicator delay,                                                                                                                                                                                          
			// so it can be restored later on. Busy handling on the master list is                                                                                                                                                                                      
			// taken care of by the master list itself.                                                                                                                                                                                                                 
			var iOriginalBusyDelay = oList.getBusyIndicatorDelay();                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
			// Make sure, busy indication is showing immediately so there is no                                                                                                                                                                                         
			// break after the busy indication for loading the view's meta data is                                                                                                                                                                                      
			// ended (see promise 'oWhenMetadataIsLoaded' in AppController)                                                                                                                                                                                             
			oList.attachEventOnce("updateFinished", function() {                                                                                                                                                                                                        
				// Restore original busy indicator delay for the list                                                                                                                                                                                                      
				oViewModel.setProperty("/delay", iOriginalBusyDelay);                                                                                                                                                                                                      
			});                                                                                                                                                                                                                                                         
			oList.attachEvent("updateFinished", this.onListUpdated, this);                                                                                                                                                                                              
			this._oList = oList;                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			this.getRouter().getRoute("master").attachPatternMatched(this._onMasterMatched, this);                                                                                                                                                                      
			this.getRouter().attachBypassed(this.onBypassed, this);                                                                                                                                                                                                     
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onExit: function() {                                                                                                                                                                                                                                         
			var oEventBus = sap.ui.getCore().getEventBus();                                                                                                                                                                                                             
			oEventBus.unsubscribe("com.mscg.applications.cubiscan.measure.FioriConfiguration", "Loaded", this.onFioriConfigurationLoaded, this);                                                                                                                        
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/* =========================================================== */                                                                                                                                                                                            
		/* event handlers                                              */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		onFioriConfigurationLoaded: function(sChannel, sEvent, oData) {                                                                                                                                                                                              
			// Bind the warehouse number input.                                                                                                                                                                                                                         
			var oWarehouseNumberInput = this.byId("warehouseNumberInput");                                                                                                                                                                                              
			var oFioriConfigurationModel = this.getOwnerComponent().getModel("fioriConfiguration");                                                                                                                                                                     
			oWarehouseNumberInput.setModel(oFioriConfigurationModel);                                                                                                                                                                                                   
			oWarehouseNumberInput.bindValue({                                                                                                                                                                                                                           
				path: "/user/defaults/warehouseNumber"                                                                                                                                                                                                                     
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			// Define the filters for use in the binding of the items.                                                                                                                                                                                                  
			var aFilters = this._constructFilters();                                                                                                                                                                                                                    
			this._bindHeaderData(this._oList, aFilters, null);                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			// Fire a message into the pub sub queue for any listeners.                                                                                                                                                                                                 
			var oEventBus = sap.ui.getCore().getEventBus();                                                                                                                                                                                                             
			oEventBus.publish("com.mscg.applications.cubiscan.measure.WarehouseNumber", "Changed", {                                                                                                                                                                    
				warehouseNumber: oFioriConfigurationModel.getProperty("/user/defaults/warehouseNumber")                                                                                                                                                                    
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onListUpdated: function() {                                                                                                                                                                                                                                  
			this.getOwnerComponent().oListSelector.oWhenListLoadingIsDone.then(                                                                                                                                                                                         
				function(mParams) {                                                                                                                                                                                                                                        
					if (mParams.list.getMode() === "None") {                                                                                                                                                                                                                  
						return;                                                                                                                                                                                                                                                  
					}                                                                                                                                                                                                                                                         
					var oBindingContext = mParams.firstListitem.getBindingContext();                                                                                                                                                                                          
					this.getOwnerComponent().oListSelector.selectAListItem(oBindingContext.getPath());                                                                                                                                                                        
					this._showDetail(mParams.firstListitem);                                                                                                                                                                                                                  
				}.bind(this),                                                                                                                                                                                                                                              
				function(mParams) {                                                                                                                                                                                                                                        
					if (mParams.error) {                                                                                                                                                                                                                                      
						return;                                                                                                                                                                                                                                                  
					}                                                                                                                                                                                                                                                         
					this.getRouter().getTargets().display("detailNoObjectsAvailable");                                                                                                                                                                                        
				}.bind(this)                                                                                                                                                                                                                                               
			);                                                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onWarehouseNumberValueHelpRequest: function(oEvent) {                                                                                                                                                                                                        
			var handleClose = function(oEventObj) {                                                                                                                                                                                                                     
				var oSelectedItem = oEventObj.getParameter("selectedItem");                                                                                                                                                                                                
				if (oSelectedItem) {                                                                                                                                                                                                                                       
					this.byId("warehouseNumberInput").setValue(oSelectedItem.getTitle());                                                                                                                                                                                     
				}                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				// Create the filters and refresh.                                                                                                                                                                                                                         
				var filters = this._constructFilters();                                                                                                                                                                                                                    
				this._oList.unbindAggregation("items");                                                                                                                                                                                                                    
				this._bindHeaderData(this._oList, filters, null);                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				// Fire a message into the pub sub queue for any listeners.                                                                                                                                                                                                
				var oEventBus = sap.ui.getCore().getEventBus();                                                                                                                                                                                                            
				oEventBus.publish("com.mscg.applications.cubiscan.measure.WarehouseNumber", "Changed", {                                                                                                                                                                   
					warehouseNumber: oSelectedItem.getTitle()                                                                                                                                                                                                                 
				});                                                                                                                                                                                                                                                        
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			var selDialog = new sap.m.SelectDialog({                                                                                                                                                                                                                    
				title: "Warehouses",                                                                                                                                                                                                                                       
				items: {                                                                                                                                                                                                                                                   
					path: "/WarehouseNumberSet",                                                                                                                                                                                                                              
					template: new sap.m.StandardListItem({                                                                                                                                                                                                                    
						title: "{warehouseNumber}",                                                                                                                                                                                                                              
						description: "{description}",                                                                                                                                                                                                                            
						active: true                                                                                                                                                                                                                                             
					})                                                                                                                                                                                                                                                        
				},                                                                                                                                                                                                                                                         
				confirm: [handleClose, this],                                                                                                                                                                                                                              
				cancel: [handleClose, this]                                                                                                                                                                                                                                
			});                                                                                                                                                                                                                                                         
			selDialog.setModel(this.getOwnerComponent().getModel("mscgCommon"));                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			// toggle compact style                                                                                                                                                                                                                                     
			jQuery.sap.syncStyleClass("sapUiSizeCompact", this.getView(), selDialog);                                                                                                                                                                                   
			selDialog.open();                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * After list data is available, this handler method updates the                                                                                                                                                                                             
		 * master list counter and hides the pull to refresh control, if                                                                                                                                                                                             
		 * necessary.                                                                                                                                                                                                                                                
		 * @param {sap.ui.base.Event} oEvent the update finished event                                                                                                                                                                                               
		 * @public                                                                                                                                                                                                                                                   
		 */                                                                                                                                                                                                                                                          
		onUpdateFinished: function(oEvent) {                                                                                                                                                                                                                         
			// update the master list object counter after new data is loaded                                                                                                                                                                                           
			this._updateListItemCount(oEvent.getParameter("total"));                                                                                                                                                                                                    
			// hide pull to refresh if necessary                                                                                                                                                                                                                        
			this.byId("pullToRefresh").hide();                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Event handler for the master search field. Applies current                                                                                                                                                                                                
		 * filter value and triggers a new search. If the search field's                                                                                                                                                                                             
		 * 'refresh' button has been pressed, no new search is triggered                                                                                                                                                                                             
		 * and the list binding is refresh instead.                                                                                                                                                                                                                  
		 * @param {sap.ui.base.Event} oEvent the search event                                                                                                                                                                                                        
		 * @public                                                                                                                                                                                                                                                   
		 */                                                                                                                                                                                                                                                          
		onSearch: function(oEvent) {                                                                                                                                                                                                                                 
			if (oEvent.getParameters().refreshButtonPressed) {                                                                                                                                                                                                          
				// Search field's 'refresh' button has been pressed.                                                                                                                                                                                                       
				// This is visible if you select any master list item.                                                                                                                                                                                                     
				// In this case no new search is triggered, we only                                                                                                                                                                                                        
				// refresh the list binding.                                                                                                                                                                                                                               
				this.onRefresh();                                                                                                                                                                                                                                          
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Update the filters and search.                                                                                                                                                                                                                           
			var sQuery = oEvent.getParameter("query");                                                                                                                                                                                                                  
			var filters = this._constructFilters();                                                                                                                                                                                                                     
			this._oList.unbindAggregation("items");                                                                                                                                                                                                                     
			this._bindHeaderData(this._oList, filters, sQuery);                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Event handler for refresh event. Keeps filter, sort                                                                                                                                                                                                       
		 * and group settings and refreshes the list binding.                                                                                                                                                                                                        
		 * @public                                                                                                                                                                                                                                                   
		 */                                                                                                                                                                                                                                                          
		onRefresh: function() {                                                                                                                                                                                                                                      
			this._oList.getBinding("items").refresh();                                                                                                                                                                                                                  
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Event handler for the list selection event                                                                                                                                                                                                                
		 * @param {sap.ui.base.Event} oEvent the list selectionChange event                                                                                                                                                                                          
		 * @public                                                                                                                                                                                                                                                   
		 */                                                                                                                                                                                                                                                          
		onSelectionChange: function(oEvent) {                                                                                                                                                                                                                        
			// get the list item, either from the listItem parameter or from the event's source itself (will depend on the device-dependent mode).                                                                                                                      
			this._showDetail(oEvent.getParameter("listItem") || oEvent.getSource());                                                                                                                                                                                    
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Event handler for the bypassed event, which is fired when no routing pattern matched.                                                                                                                                                                     
		 * If there was an object selected in the master list, that selection is removed.                                                                                                                                                                            
		 * @public                                                                                                                                                                                                                                                   
		 */                                                                                                                                                                                                                                                          
		onBypassed: function() {                                                                                                                                                                                                                                     
			this._oList.removeSelections(true);                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Used to create GroupHeaders with non-capitalized caption.                                                                                                                                                                                                 
		 * These headers are inserted into the master list to                                                                                                                                                                                                        
		 * group the master list's items.                                                                                                                                                                                                                            
		 * @param {Object} oGroup group whose text is to be displayed                                                                                                                                                                                                
		 * @public                                                                                                                                                                                                                                                   
		 * @returns {sap.m.GroupHeaderListItem} group header with non-capitalized caption.                                                                                                                                                                           
		 */                                                                                                                                                                                                                                                          
		createGroupHeader: function(oGroup) {                                                                                                                                                                                                                        
			return new GroupHeaderListItem({                                                                                                                                                                                                                            
				title: oGroup.text,                                                                                                                                                                                                                                        
				upperCase: false                                                                                                                                                                                                                                           
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Event handler for navigating back.                                                                                                                                                                                                                        
		 * It there is a history entry or an previous app-to-app navigation we go one step back in the browser history                                                                                                                                               
		 * If not, it will navigate to the shell home                                                                                                                                                                                                                
		 * @public                                                                                                                                                                                                                                                   
		 */                                                                                                                                                                                                                                                          
		onNavBack: function() {                                                                                                                                                                                                                                      
			var sPreviousHash = History.getInstance().getPreviousHash(),                                                                                                                                                                                                
				oCrossAppNavigator = sap.ushell.Container.getService("CrossApplicationNavigation");                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			if (sPreviousHash !== undefined || !oCrossAppNavigator.isInitialNavigation()) {                                                                                                                                                                             
				history.go(-1);                                                                                                                                                                                                                                            
			} else {                                                                                                                                                                                                                                                    
				oCrossAppNavigator.toExternal({                                                                                                                                                                                                                            
					target: {                                                                                                                                                                                                                                                 
						shellHash: "#Shell-home"                                                                                                                                                                                                                                 
					}                                                                                                                                                                                                                                                         
				});                                                                                                                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/* =========================================================== */                                                                                                                                                                                            
		/* begin: internal methods                                     */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		_bindHeaderData: function(oList, aFilters, sQuery) {                                                                                                                                                                                                         
			if (sQuery) {                                                                                                                                                                                                                                               
				aFilters.push(new Filter("product", FilterOperator.Contains, sQuery));                                                                                                                                                                                     
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Bind the list.                                                                                                                                                                                                                                           
			var itemTemplate = new sap.m.ObjectListItem({                                                                                                                                                                                                               
				press: "onSelectionChange",                                                                                                                                                                                                                                
				title: "{product}",                                                                                                                                                                                                                                        
				icon: "{productImage}",                                                                                                                                                                                                                                    
				attributes: [{                                                                                                                                                                                                                                             
					text: "{productDescription}"                                                                                                                                                                                                                              
				}]                                                                                                                                                                                                                                                         
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			oList.bindAggregation("items", {                                                                                                                                                                                                                            
				path: "/WorklistHeaderSet",                                                                                                                                                                                                                                
				template: itemTemplate,                                                                                                                                                                                                                                    
				sorter: {                                                                                                                                                                                                                                                  
					path: "product",                                                                                                                                                                                                                                          
					descending: false                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				groupHeaderFactory: ".createGroupHeader",                                                                                                                                                                                                                  
				filters: aFilters                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			// Bind the list to the ListSelector so that the selection functions work.                                                                                                                                                                                  
			this.getOwnerComponent().oListSelector.setBoundMasterList(oList);                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_constructFilters: function() {                                                                                                                                                                                                                              
			var filters = new Array();                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			// Define the filters for use in the binding of the items.                                                                                                                                                                                                  
			var warehouseFilter = new sap.ui.model.Filter("warehouseNumber", sap.ui.model.FilterOperator.EQ, this.getOwnerComponent().getModel(                                                                                                                         
				"fioriConfiguration").getProperty(                                                                                                                                                                                                                         
				"/user/defaults/warehouseNumber"));                                                                                                                                                                                                                        
			filters.push(warehouseFilter);                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
			return filters;                                                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_createViewModel: function() {                                                                                                                                                                                                                               
			return new JSONModel({                                                                                                                                                                                                                                      
				isFilterBarVisible: false,                                                                                                                                                                                                                                 
				filterBarLabel: "",                                                                                                                                                                                                                                        
				delay: 0,                                                                                                                                                                                                                                                  
				title: this.getResourceBundle().getText("masterTitleCount", [0]),                                                                                                                                                                                          
				noDataText: this.getResourceBundle().getText("masterListNoDataText"),                                                                                                                                                                                      
				sortBy: "product",                                                                                                                                                                                                                                         
				groupBy: "None",                                                                                                                                                                                                                                           
				selectedWorklistCategory: "INB"                                                                                                                                                                                                                            
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * If the master route was hit (empty hash) we have to set                                                                                                                                                                                                   
		 * the hash to to the first item in the list as soon as the                                                                                                                                                                                                  
		 * listLoading is done and the first item in the list is known                                                                                                                                                                                               
		 * @private                                                                                                                                                                                                                                                  
		 */                                                                                                                                                                                                                                                          
		_onMasterMatched: function() {},                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Shows the selected item on the detail page                                                                                                                                                                                                                
		 * On phones a additional history entry is created                                                                                                                                                                                                           
		 * @param {sap.m.ObjectListItem} oItem selected Item                                                                                                                                                                                                         
		 * @private                                                                                                                                                                                                                                                  
		 */                                                                                                                                                                                                                                                          
		_showDetail: function(oItem) {                                                                                                                                                                                                                               
			var bReplace = !Device.system.phone;                                                                                                                                                                                                                        
			this.getRouter().navTo("object", {                                                                                                                                                                                                                          
				warehouse: oItem.getBindingContext().getProperty("warehouseNumber"),                                                                                                                                                                                       
				product: oItem.getBindingContext().getProperty("product"),                                                                                                                                                                                                 
				timestamp: new Date().getTime()                                                                                                                                                                                                                            
			}, bReplace);                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Sets the item count on the master list header                                                                                                                                                                                                             
		 * @param {integer} iTotalItems the total number of items in the list                                                                                                                                                                                        
		 * @private                                                                                                                                                                                                                                                  
		 */                                                                                                                                                                                                                                                          
		_updateListItemCount: function(iTotalItems) {                                                                                                                                                                                                                
			var sTitle;                                                                                                                                                                                                                                                 
			// only update the counter if the length is final                                                                                                                                                                                                           
			if (this._oList.getBinding("items").isLengthFinal()) {                                                                                                                                                                                                      
				sTitle = this.getResourceBundle().getText("masterTitleCount", [iTotalItems]);                                                                                                                                                                              
				this.getModel("masterView").setProperty("/title", sTitle);                                                                                                                                                                                                 
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Internal helper method to apply both filter and search state together on the list binding                                                                                                                                                                 
		 * @private                                                                                                                                                                                                                                                  
		 */                                                                                                                                                                                                                                                          
		/*_applyFilterSearch: function() {                                                                                                                                                                                                                           
			var aFilters = this._oListFilterState.aSearch.concat(this._oListFilterState.aFilter),                                                                                                                                                                       
				oViewModel = this.getModel("masterView");                                                                                                                                                                                                                  
			this._oList.getBinding("items").filter(aFilters, "Application");                                                                                                                                                                                            
			// changes the noDataText of the list in case there are no filter results                                                                                                                                                                                   
			if (aFilters.length !== 0) {                                                                                                                                                                                                                                
				oViewModel.setProperty("/noDataText", this.getResourceBundle().getText("masterListNoDataWithFilterOrSearchText"));                                                                                                                                         
			} else if (this._oListFilterState.aSearch.length > 0) {                                                                                                                                                                                                     
				// only reset the no data text to default when no new search was triggered                                                                                                                                                                                 
				oViewModel.setProperty("/noDataText", this.getResourceBundle().getText("masterListNoDataText"));                                                                                                                                                           
			}                                                                                                                                                                                                                                                           
		},*/                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Internal helper method to apply both group and sort state together on the list binding                                                                                                                                                                    
		 * @param {sap.ui.model.Sorter[]} aSorters an array of sorters                                                                                                                                                                                               
		 * @private                                                                                                                                                                                                                                                  
		 */                                                                                                                                                                                                                                                          
		_applyGroupSort: function(aSorters) {                                                                                                                                                                                                                        
			this._oList.getBinding("items").sort(aSorters);                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Internal helper method that sets the filter bar visibility property and the label's caption to be shown                                                                                                                                                   
		 * @param {string} sFilterBarText the selected filter value                                                                                                                                                                                                  
		 * @private                                                                                                                                                                                                                                                  
		 */                                                                                                                                                                                                                                                          
		_updateFilterBar: function(sFilterBarText) {                                                                                                                                                                                                                 
			var oViewModel = this.getModel("masterView");                                                                                                                                                                                                               
			oViewModel.setProperty("/isFilterBarVisible", (this._oListFilterState.aFilter.length > 0));                                                                                                                                                                 
			oViewModel.setProperty("/filterBarLabel", this.getResourceBundle().getText("masterFilterBarText", [sFilterBarText]));                                                                                                                                       
		}                                                                                                                                                                                                                                                            
	});                                                                                                                                                                                                                                                           
});                                                                                                                                                                                                                                                            